{"version":3,"sources":["webpack://integration/./src/server/TeamsAppsComponents.ts?6a42","webpack://integration/./src/server/boxTab/BoxTab.ts?4c96","webpack://integration/external \"box-node-sdk\"?13b3","webpack://integration/external \"compression\"?f791","webpack://integration/external \"debug\"?b2c7","webpack://integration/external \"dotenv\"?e70f","webpack://integration/external \"express\"?22fe","webpack://integration/external \"express-msteams-host\"?e438","[]","webpack://integration/external \"morgan\"?3206","webpack://integration/external \"path\"?74bb","webpack://integration/webpack/bootstrap?7f80","webpack://integration/./src/server/server.ts?3175"],"names":["nonce","BoxTab","PreventIframe","module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call","log","debug","express","Express","port","process","env","PORT","get","req","res","authorizationUrl","CLIENT_ID","redirect","client","id","secret","CLIENT_SECRET","send","use","json","verify","buf","encoding","rawBody","toString","urlencoded","extended","set","path","join","__dirname","morgan","compression","static","MsTeamsApiRouter","allComponents","MsTeamsPageRouter","root","components","index","http","createServer","listen"],"mappings":"ubACa,EAAAA,MAAQ,GAErB,a,sbCHA,cAQA,IAAaC,EAAb,QAAaA,EAAM,GAHlB,EAAAC,cAAc,sBACd,EAAAA,cAAc,uBACd,EAAAA,cAAc,wBACFD,GAAA,EAAAA,U,OCRbE,EAAOC,QAAUC,QAAQ,iB,QCAzBF,EAAOC,QAAUC,QAAQ,gB,QCAzBF,EAAOC,QAAUC,QAAQ,U,QCAzBF,EAAOC,QAAUC,QAAQ,W,QCAzBF,EAAOC,QAAUC,QAAQ,Y,OCAzBF,EAAOC,QAAUC,QAAQ,yB,QCAzBF,EAAOC,QAAUC,QAAQ,S,QCAzBF,EAAOC,QAAUC,QAAQ,W,QCAzBF,EAAOC,QAAUC,QAAQ,UCCrBC,EAA2B,GAG/B,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaL,QAGrB,IAAID,EAASG,EAAyBE,GAAY,CAGjDJ,QAAS,IAOV,OAHAO,EAAoBH,GAAUI,KAAKT,EAAOC,QAASD,EAAQA,EAAOC,QAASG,GAGpEJ,EAAOC,Q,MCrBf,eACA,SACA,SACA,SACA,QACA,SACA,SAIMS,GAHS,EAAQ,IAGXC,EAAM,YAElBD,EAAI,sDAGJ,gBAIA,eAGME,EAAUC,IACVC,EAAOC,QAAQC,IAAIF,MAAQC,QAAQC,IAAIC,MAAQ,KAErDL,EAAQM,IAAI,SAAS,SAAUC,EAAKC,GAChC,MAEMC,EAAmB,0DADLN,QAAQC,IAAIM,+BAEhCF,EAAIG,SAASF,MAGjBT,EAAQM,IAAI,WAAW,SAAUC,EAAKC,GAClC,MAAMI,EAAc,CAChBC,GAAI,GAAGV,QAAQC,IAAIM,YACnBI,OAAQ,GAAGX,QAAQC,IAAIW,iBAG3BP,EAAIQ,KAAKJ,MAIbZ,EAAQiB,IACJhB,EAAQiB,KAAK,CACTC,OAAQ,CAACZ,EAAKC,EAAKY,EAAaC,KAC3Bd,EAAYe,QAAUF,EAAIG,eAIvCvB,EAAQiB,IAAIhB,EAAQuB,WAAW,CAAEC,UAAU,KAG3CzB,EAAQ0B,IAAI,QAASC,EAAKC,KAAKC,UAAW,MAG1C7B,EAAQiB,IAAIa,EAAO,SAGnB9B,EAAQiB,IAAIc,KAGZ/B,EAAQiB,IAAI,WAAYhB,EAAQ+B,OAAOL,EAAKC,KAAKC,UAAW,iBAC5D7B,EAAQiB,IAAI,UAAWhB,EAAQ+B,OAAOL,EAAKC,KAAKC,UAAW,gBAI3D7B,EAAQiB,IAAI,EAAAgB,iBAAiBC,IAI7BlC,EAAQiB,IACJ,EAAAkB,kBAAkB,CACdC,KAAMT,EAAKC,KAAKC,UAAW,QAC3BQ,WAAYH,KAKpBlC,EAAQiB,IACJ,IACAhB,EAAQ+B,OAAOL,EAAKC,KAAKC,UAAW,QAAS,CACzCS,MAAO,gBAKftC,EAAQ0B,IAAI,OAAQxB,GAGpBqC,EAAKC,aAAaxC,GAASyC,OAAOvC,GAAM,KACpCJ,EAAI,qBAAqBI,S","file":"server.js","sourcesContent":["// Components will be added here\nexport const nonce = {}; // Do not remove!\n// Automatically added for the boxTab tab\nexport * from \"./boxTab/BoxTab\";\n","import { PreventIframe } from \"express-msteams-host\";\n\n/**\n * Used as place holder for the decorators\n */\n@PreventIframe(\"/boxTab/index.html\")\n@PreventIframe(\"/boxTab/config.html\")\n@PreventIframe(\"/boxTab/remove.html\")\nexport class BoxTab {\n}\n","module.exports = require(\"box-node-sdk\");;","module.exports = require(\"compression\");;","module.exports = require(\"debug\");;","module.exports = require(\"dotenv\");;","module.exports = require(\"express\");;","module.exports = require(\"express-msteams-host\");;","module.exports = require(\"http\");;","module.exports = require(\"morgan\");;","module.exports = require(\"path\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import * as Express from \"express\";\nimport * as http from \"http\";\nimport * as path from \"path\";\nimport * as morgan from \"morgan\";\nimport { MsTeamsApiRouter, MsTeamsPageRouter } from \"express-msteams-host\";\nimport * as debug from \"debug\";\nimport * as compression from \"compression\";\nconst BoxSDK = require(\"box-node-sdk\");\n\n// Initialize debug logging module\nconst log = debug(\"msteams\");\n\nlog(\"Initializing Microsoft Teams Express hosted App...\");\n\n// Initialize dotenv, to use .env file settings if existing\nrequire(\"dotenv\").config();\n\n// The import of components has to be done AFTER the dotenv config\n// eslint-disable-next-line import/first\nimport * as allComponents from \"./TeamsAppsComponents\";\n\n// Create the Express webserver\nconst express = Express();\nconst port = process.env.port || process.env.PORT || 3007;\n\nexpress.get(\"/auth\", function (req, res) {\n    const baseUrl = \"https://account.box.com/api/oauth2/authorize\";\n    const clientId = `${process.env.CLIENT_ID}`;\n    const authorizationUrl = `${baseUrl}?client_id=${clientId}&response_type=code`;\n    res.redirect(authorizationUrl);\n});\n\nexpress.get(\"/client\", function (req, res) {\n    const client: any = {\n        id: `${process.env.CLIENT_ID}`,\n        secret: `${process.env.CLIENT_SECRET}`\n    };\n\n    res.send(client);\n});\n\n// Inject the raw request body onto the request object\nexpress.use(\n    Express.json({\n        verify: (req, res, buf: Buffer, encoding: string): void => {\n            (req as any).rawBody = buf.toString();\n        }\n    })\n);\nexpress.use(Express.urlencoded({ extended: true }));\n\n// Express configuration\nexpress.set(\"views\", path.join(__dirname, \"/\"));\n\n// Add simple logging\nexpress.use(morgan(\"tiny\"));\n\n// Add compression - uncomment to remove compression\nexpress.use(compression());\n\n// Add /scripts and /assets as static folders\nexpress.use(\"/scripts\", Express.static(path.join(__dirname, \"web/scripts\")));\nexpress.use(\"/assets\", Express.static(path.join(__dirname, \"web/assets\")));\n\n// routing for bots, connectors and incoming web hooks - based on the decorators\n// For more information see: https://www.npmjs.com/package/express-msteams-host\nexpress.use(MsTeamsApiRouter(allComponents));\n\n// routing for pages for tabs and connector configuration\n// For more information see: https://www.npmjs.com/package/express-msteams-host\nexpress.use(\n    MsTeamsPageRouter({\n        root: path.join(__dirname, \"web/\"),\n        components: allComponents\n    })\n);\n\n// Set default web page\nexpress.use(\n    \"/\",\n    Express.static(path.join(__dirname, \"web/\"), {\n        index: \"index.html\"\n    })\n);\n\n// Set the port\nexpress.set(\"port\", port);\n\n// Start the webserver\nhttp.createServer(express).listen(port, () => {\n    log(`Server running on ${port}`);\n});\n"],"sourceRoot":""}