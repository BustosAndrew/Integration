<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Box Tab</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=es6,Intl"></script>
        <link
            rel="stylesheet"
            href="https://cdn01.boxcdn.net/platform/elements/11.0.2/en-US/explorer.css"
        />
        <link href="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/picker.css" rel="stylesheet" type="text/css"></link>
        <link href="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/uploader.css" rel="stylesheet" type="text/css"></link>
        <link href="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/openwith.css" rel="stylesheet" type="text/css"></link>
        <link href="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/preview.css" rel="stylesheet" type="text/css"></link>
        <link href="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/sidebar.css" rel="stylesheet" type="text/css"></link>
        <!-- inject:css -->
        <link rel="stylesheet" href="/styles/main.css">
        <!-- endinject -->
    </head>

    <body>
        <div id="app">Loading...</div>
        <!-- <div class="container"></div> -->
        <!-- inject:js -->
        <script src="/scripts/client.js"></script>
        <!-- endinject -->
        <script type="text/javascript">
            integration.render(
                integration.BoxTab,
                document.getElementById("app"),
                {}
            );
        </script>
        <script src="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/explorer.js"></script>
        <script src="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/picker.js"></script>
        <script src="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/uploader.js"></script>
        <script src="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/preview.js"></script>
        <script src="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/openwith.js"></script>
        <script src="https://cdn01.boxcdn.net/platform/preview/2.69.0/en-US/preview.js"></script>
        <script src="https://cdn01.boxcdn.net/platform/elements/13.0.0/en-US/sidebar.js"></script>
        <script>
            const authUrl = integration
                .getAuthUrl()
                .then((authorizationUrl) => {
                    integration.getTeamsRef().authentication.authenticate({
                        url: "https://box-integration-tab.herokuapp.com/?url="+ encodeURIComponent(authorizationUrl),
                        width: 600,
                        height: 900,
                        successCallback: function (result) {
                            integration
                                .getToken(result)
                                .then(function (access_token) {
                                    let folderId = "0";
                                    const contentExplorer = new Box.ContentExplorer();
                                    contentExplorer.show(
                                        folderId,
                                        `${access_token}`,
                                        {
                                            container: ".container"
                                        }
                                    );
                                });
                        },
                        failureCallback: () => {
                            console.log("Error authenticating client.");
                        }
                    });
                });
        </script>
    </body>
</html>
